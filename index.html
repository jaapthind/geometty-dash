<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liquid Glass V7 // Molten Engine</title>
    <style>
        :root {
            --glass-clear: rgba(255, 255, 255, 0.12);
            --glass-border: rgba(255, 255, 255, 0.3);
            --accent: #ffffff;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', system-ui, sans-serif; }
        body { background: #000; height: 100vh; overflow: hidden; display: flex; align-items: center; justify-content: center; }

        /* --- THE MOLTEN ENGINE --- */
        #molten-canvas {
            position: fixed;
            inset: 0;
            z-index: -1;
            filter: url(#molten-glass-filter) contrast(1.2) saturate(1.4);
            background: radial-gradient(circle at center, #111, #000);
        }

        /* --- UI WRAPPER --- */
        #interface {
            display: flex;
            gap: 40px;
            align-items: flex-start;
            z-index: 10;
        }

        /* --- SETTINGS: ACTUAL LIQUID GLASS STYLE --- */
        .glass-panel {
            width: 320px;
            padding: 30px;
            border-radius: 24px;
            background: var(--glass-clear);
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(40px);
            -webkit-backdrop-filter: blur(40px);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.8);
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        /* --- NORMAL SIZED CHAT --- */
        #chat-container {
            width: 420px; /* Small/Medium Normal Size */
            height: 600px;
            border-radius: 24px;
            overflow: hidden;
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        iframe { width: 100%; height: 100%; border: none; }

        /* Controls */
        h2 { font-size: 11px; letter-spacing: 3px; margin-bottom: 20px; opacity: 0.7; }
        .control-row { margin-bottom: 15px; }
        label { display: block; font-size: 10px; margin-bottom: 5px; font-weight: bold; }
        input[type="range"] { width: 100%; cursor: pointer; accent-color: #fff; }

        /* Permissions Modal */
        #overlay {
            position: fixed; inset: 0; background: #000; z-index: 999;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .start-btn {
            padding: 20px 50px; background: white; color: black; border: none;
            border-radius: 40px; font-weight: 900; cursor: pointer; font-size: 16px;
        }
    </style>
</head>
<body>

    <div id="overlay">
        <h1 style="color:white; letter-spacing:10px; margin-bottom:20px;">SYSTEM BOOT</h1>
        <button class="start-btn" onclick="bootSystem()">INITIALIZE MOLTEN LINK</button>
    </div>

    <svg width="0" height="0">
        <defs>
            <filter id="molten-glass-filter">
                <feTurbulence type="fractalNoise" baseFrequency="0.01 0.015" numOctaves="2" seed="5" result="noise">
                    <animate attributeName="baseFrequency" values="0.01 0.015; 0.015 0.01; 0.01 0.015" dur="20s" repeatCount="indefinite"/>
                </feTurbulence>
                <feGaussianBlur in="noise" stdDeviation="5" result="blurredNoise"/>
                <feDisplacementMap in="SourceGraphic" in2="blurredNoise" scale="120" xChannelSelector="R" yChannelSelector="G"/>
            </filter>
        </defs>
    </svg>

    <canvas id="molten-canvas"></canvas>
    <video id="v" style="display:none" autoplay playsinline></video>

    <div id="interface">
        <div class="glass-panel">
            <h2>LIQUID CORE V7</h2>
            <div class="control-row">
                <label>REFRACTION INTENSITY</label>
                <input type="range" id="refract" min="10" max="300" value="150">
            </div>
            <div class="control-row">
                <label>RAINBOW DENSITY</label>
                <input type="range" id="rainbow" min="0" max="100" value="60">
            </div>
            <div class="control-row">
                <label>FLUID SPEED</label>
                <input type="range" id="speed" min="1" max="100" value="30">
            </div>
            <div class="control-row" style="margin-top:30px; border-top:1px solid rgba(255,255,255,0.1); padding-top:20px;">
                <p id="lat-log" style="font-size:10px; color:#aaa;">GPS: OFFLINE</p>
                <p id="cpu-load" style="font-size:10px; color:#aaa; margin-top:5px;">CPU_SYNC: READY</p>
            </div>
        </div>

        <div id="chat-container">
            <iframe src="https://deadsimplechat.com/J4fFLy4Ek"></iframe>
        </div>
    </div>

<script>
    const canvas = document.getElementById('molten-canvas');
    const ctx = canvas.getContext('2d');
    const video = document.getElementById('v');
    let audioData, analyser;

    async function bootSystem() {
        document.getElementById('overlay').style.display = 'none';

        // 1. Camera & Mic
        const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
        video.srcObject = stream;

        // 2. Audio Setup
        const ac = new AudioContext();
        analyser = ac.createAnalyser();
        ac.createMediaStreamSource(stream).connect(analyser);
        audioData = new Uint8Array(analyser.frequencyBinCount);

        // 3. Location
        navigator.geolocation.getCurrentPosition(p => {
            document.getElementById('lat-log').innerText = `GPS: ${p.coords.latitude.toFixed(2)}N, ${p.coords.longitude.toFixed(2)}E`;
        });

        requestAnimationFrame(render);
    }

    function render() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let vol = 0;
        if(analyser) {
            analyser.getByteFrequencyData(audioData);
            vol = audioData.reduce((a,b) => a+b) / audioData.length;
        }

        // Update SVG scale based on mic and slider
        const baseRefract = document.getElementById('refract').value;
        document.getElementById('molten-glass-filter').querySelector('feDisplacementMap').setAttribute('scale', Number(baseRefract) + (vol * 1.5));

        // Draw Molten Rainbow Blobs
        ctx.clearRect(0,0, canvas.width, canvas.height);
        
        const speed = document.getElementById('speed').value / 2000;
        const rainbowVal = document.getElementById('rainbow').value;
        const time = Date.now() * speed;

        for(let i=0; i<8; i++) {
            const x = canvas.width/2 + Math.cos(time + i) * (canvas.width * 0.3);
            const y = canvas.height/2 + Math.sin(time*0.7 + i) * (canvas.height * 0.3);
            const size = 400 + (vol * 2);

            ctx.save();
            ctx.beginPath();
            ctx.arc(x, y, size/2, 0, Math.PI*2);
            ctx.clip();

            // RAINBOW LIQUID LOGIC
            const hue = (time * 50 + (i * 45)) % 360;
            ctx.filter = `hue-rotate(${hue}deg) saturate(${rainbowVal}%) brightness(1.1)`;
            ctx.drawImage(video, x - size/2, y - size/2, size, size);
            ctx.restore();
        }

        // Add a "Clear Glass" sheen over everything
        ctx.fillStyle = 'rgba(255,255,255,0.03)';
        ctx.fillRect(0,0, canvas.width, canvas.height);

        requestAnimationFrame(render);
    }
</script>

</body>
</html>
