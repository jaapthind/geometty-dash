<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>macOS Tahoe Infinity ULTRA MAX</title>
<style>
:root{
    --glass: rgba(255,255,255,0.18);
    --glass-strong: rgba(255,255,255,0.38);
    --glass-dark: rgba(20,20,25,0.75);
    --blur: blur(60px) saturate(200%);
    --radius: 18px;
    --accent: #007aff;
    --danger: #ff3b30;
    --success: #28c840;
    --warn: #ff9f0a;
    --menu-h: 32px;
    --dock-h: 96px;
    --shadow: 0 40px 120px rgba(0,0,0,.6);
}
*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","Helvetica Neue",sans-serif;user-select:none;}
html,body{width:100%;height:100%;overflow:hidden;background:#000;}
#boot-screen{position:fixed;inset:0;background:black;display:flex;flex-direction:column;align-items:center;justify-content:center;color:white;z-index:99999999;transition:opacity 1.2s ease;}
#boot-logo{font-size:100px;animation:pulse 2s infinite ease-in-out;}
@keyframes pulse{0%{opacity:.3}50%{opacity:1}100%{opacity:.3}}
#menu-bar{position:absolute;top:0;width:100%;height:var(--menu-h);backdrop-filter:var(--blur);background:var(--glass);border-bottom:1px solid rgba(255,255,255,0.2);display:flex;justify-content:space-between;align-items:center;padding:0 20px;font-size:13px;color:white;z-index:100000;}
.menu-left,.menu-right{display:flex;align-items:center;gap:18px;}
.menu-item{cursor:pointer;}
.menu-item.bold{font-weight:600;}
#workspace{position:absolute;top:var(--menu-h);width:100%;height:calc(100% - var(--menu-h));overflow:hidden;}
.window{position:absolute;width:920px;height:620px;border-radius:var(--radius);background:rgba(255,255,255,0.92);backdrop-filter:var(--blur);box-shadow:var(--shadow);display:flex;flex-direction:column;overflow:hidden;transition:transform .25s ease,opacity .25s ease;}
.window.dark{background:var(--glass-dark);color:white;}
.titlebar{height:42px;display:flex;align-items:center;padding:0 15px;cursor:grab;background:linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.2));}
.window.dark .titlebar{background:rgba(255,255,255,0.05);}
.traffic{display:flex;gap:8px;margin-right:20px;}
.dot{width:12px;height:12px;border-radius:50%;}
.red{background:#ff5f57;}
.yellow{background:#febc2e;}
.green{background:#28c840;}
.title{flex:1;text-align:center;font-weight:600;font-size:13px;pointer-events:none;}
.window-body{flex:1;overflow:auto;}
#dock-container{position:absolute;bottom:12px;width:100%;display:flex;justify-content:center;z-index:100000;}
#dock{height:var(--dock-h);padding:12px 25px;backdrop-filter:var(--blur);background:var(--glass);border-radius:30px;display:flex;align-items:flex-end;gap:16px;}
.dock-icon{width:56px;height:56px;border-radius:18px;background:white;cursor:pointer;transition:all .15s ease;position:relative;}
.dock-icon:hover{transform:scale(1.45) translateY(-18px);}
.dock-dot{position:absolute;bottom:-8px;left:50%;transform:translateX(-50%);width:6px;height:6px;border-radius:50%;background:white;opacity:0;}
.dock-dot.active{opacity:1;}
#notifications{position:absolute;right:20px;top:60px;width:320px;display:flex;flex-direction:column;gap:15px;z-index:200000;}
.notification{background:var(--glass-strong);backdrop-filter:var(--blur);padding:16px;border-radius:var(--radius);color:white;animation:slide .4s ease;}
@keyframes slide{from{transform:translateX(120px);opacity:0}to{transform:translateX(0);opacity:1}}
</style>
</head>
<body>
<div id="boot-screen"><div id="boot-logo">ï£¿</div><div>Starting macOS Tahoe Infinity ULTRA MAX...</div></div>
<div id="menu-bar">
<div class="menu-left"><span class="menu-item bold">ï£¿</span><span class="menu-item bold" id="active-app">Finder</span><span class="menu-item">File</span><span class="menu-item">Edit</span><span class="menu-item">View</span><span class="menu-item">Go</span><span class="menu-item">Window</span><span class="menu-item">Help</span></div>
<div class="menu-right"><span>ðŸ”‹ 100%</span><span>ðŸ“¶</span><span id="clock"></span></div>
</div>
<div id="workspace"></div>
<div id="dock-container"><div id="dock"></div></div>
<div id="notifications"></div>

<script>
// ===================== CORE ULTRA KERNEL =====================
class UltraKernel{
    constructor(){this.processes={};this.z=1;this.registry=[];this.init();}
    init(){this.initClock();this.initBoot();this.initDock();}
    initBoot(){setTimeout(()=>{document.getElementById("boot-screen").style.opacity=0;setTimeout(()=>{document.getElementById("boot-screen").remove();this.notify("System Ready","Welcome to macOS Tahoe Infinity");},1200);},3000);}
    initClock(){setInterval(()=>{document.getElementById("clock").innerText=new Date().toLocaleString();},1000);}
    notify(title,msg){const box=document.createElement("div");box.className="notification";box.innerHTML="<b>"+title+"</b><br>"+msg;document.getElementById("notifications").appendChild(box);setTimeout(()=>box.remove(),6000);}
    initDock(){
        this.registry=[{id:"finder",name:"Finder"},{id:"safari",name:"Safari"},{id:"chat",name:"DeadSimple Chat"},{id:"terminal",name:"Terminal"},{id:"monitor",name:"Activity Monitor"},{id:"notes",name:"Notes"},{id:"appstore",name:"App Store"}];
        const dock=document.getElementById("dock");
        this.registry.forEach(app=>{
            const icon=document.createElement("div");icon.className="dock-icon";icon.onclick=()=>this.launch(app.id);
            const dot=document.createElement("div");dot.className="dock-dot";dot.id="dot-"+app.id;icon.appendChild(dot);dock.appendChild(icon);
        });
    }
    launch(id){
        if(this.processes[id]) return this.focus(id);
        const app=this.registry.find(a=>a.id===id);
        const win=document.createElement("div");win.className="window";win.style.left=200+Object.keys(this.processes).length*40+"px";win.style.top=120+Object.keys(this.processes).length*40+"px";win.style.zIndex=this.z++;
        win.innerHTML=`<div class="titlebar"><div class="traffic"><div class="dot red" onclick="OS.close('${id}')"></div><div class="dot yellow" onclick="OS.minimize('${id}')"></div><div class="dot green"></div></div><div class="title">${app.name}</div></div><div class="window-body">${this.renderApp(id)}</div>`;
        this.enableDrag(win,id);
        document.getElementById("workspace").appendChild(win);
        this.processes[id]=win;
        document.getElementById("dot-"+id).classList.add("active");
        this.focus(id);this.notify("Launched",app.name+" opened");
    }
    renderApp(id){
        if(id==="chat"){return `<iframe src="https://deadsimplechat.com/J4fFLy4Ek" style="width:100%;height:100%;border:none;"></iframe>`;}
        return `<div style="padding:30px;">${id} loading...</div>`;
    }
    focus(id){this.processes[id].style.zIndex=this.z++;document.getElementById("active-app").innerText=this.registry.find(a=>a.id===id).name;}
    close(id){const win=this.processes[id];win.remove();delete this.processes[id];document.getElementById("dot-"+id).classList.remove("active");}
    minimize(id){const win=this.processes[id];win.style.display="none";setTimeout(()=>win.style.display="flex",200);}
    enableDrag(win,id){
        const bar=win.querySelector(".titlebar");
        bar.onmousedown=(e)=>{
            this.focus(id);
            const offX=e.clientX-win.offsetLeft;const offY=e.clientY-win.offsetTop;
            document.onmousemove=(ev)=>{win.style.left=ev.clientX-offX+"px";win.style.top=ev.clientY-offY+"px";};
            document.onmouseup=()=>document.onmousemove=null;
        };
    }
}
const OS=new UltraKernel();
</script>

<script>
// ===================== VIRTUAL FILE SYSTEM =====================
class VirtualFS{constructor(){this.dbName="TahoeInfinityFS";this.init();}init(){const request=indexedDB.open(this.dbName,1);request.onupgradeneeded=(e)=>{const db=e.target.result;if(!db.objectStoreNames.contains("files")){db.createObjectStore("files",{keyPath:"path"});}};request.onsuccess=(e)=>{this.db=e.target.result;console.log("Filesystem Ready");};}saveFile(path,content){const tx=this.db.transaction("files","readwrite");tx.objectStore("files").put({path,content});}readFile(path,callback){const tx=this.db.transaction("files","readonly");const req=tx.objectStore("files").get(path);req.onsuccess=()=>callback(req.result?.content || "");}listFiles(callback){const tx=this.db.transaction("files","readonly");const store=tx.objectStore("files");const files=[];store.openCursor().onsuccess=(e)=>{const cursor=e.target.result;if(cursor){files.push(cursor.value.path);cursor.continue();} else {callback(files);}};}deleteFile(path){const tx=this.db.transaction("files","readwrite");tx.objectStore("files").delete(path);}
}
OS.fs=new VirtualFS();
</script>

<script>
// ===================== APPS RENDER =====================
OS.renderAppOriginal=OS.renderApp;
OS.renderApp=function(id){
    if(id==="finder"){return `<div style="display:flex;height:100%;"><div style="width:220px;background:rgba(0,0,0,0.05);padding:15px;"><h3>Favorites</h3><div onclick="OS.loadFiles()">Documents</div><div onclick="OS.createFile()">+ New File</div></div><div style="flex:1;padding:20px;" id="finder-files"></div></div>`;}
    if(id==="notes"){return `<textarea id="notes-area" style="width:100%;height:100%;padding:20px;font-size:16px;"></textarea>`;}
    if(id==="calc"){return `<div style="padding:30px;"><input id="calc-display" style="width:100%;font-size:40px;text-align:right;"><div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:20px;">${["7","8","9","/","4","5","6","*","1","2","3","-","0",".","=","+"].map(b=>`<button onclick="OS.calcPress('${b}')">${b}</button>`).join("")}</div></div>`;}
    if(id==="chat"){return `<iframe src="https://deadsimplechat.com/J4fFLy4Ek" style="width:100%;height:100%;border:none;"></iframe>`;}
    return OS.renderAppOriginal(id);
};
// Finder & Notes logic
OS.loadFiles=function(){OS.fs.listFiles(files=>{const container=document.getElementById("finder-files");container.innerHTML="";files.forEach(f=>{const div=document.createElement("div");div.style.padding="8px";div.style.cursor="pointer";div.innerText=f;div.onclick=()=>OS.openFile(f);container.appendChild(div);});});};
OS.createFile=function(){const name=prompt("Enter file name");if(!name) return;OS.fs.saveFile(name,"");OS.loadFiles();};
OS.openFile=function(path){OS.fs.readFile(path,(content)=>{OS.launch("notes");setTimeout(()=>{const area=document.getElementById("notes-area");if(area){area.value=content;area.oninput=()=>{OS.fs.saveFile(path,area.value);}}},300);};};
// Calculator logic
OS.calcPress=function(val){const disp=document.getElementById("calc-display");if(val==="="){try{disp.value=eval(disp.value);}catch{disp.value="Error";}}else{disp.value+=val;}};
</script>

<script>
// ===================== BOOT, LOGIN & FINAL INIT =====================
OS.showLogin=function(){
    const overlay=document.createElement("div");overlay.id="loginScreen";overlay.style.position="fixed";overlay.style.inset="0";overlay.style.background="linear-gradient(120deg,#000428,#004e92)";overlay.style.display="flex";overlay.style.flexDirection="column";overlay.style.alignItems="center";overlay.style.justifyContent="center";overlay.style.zIndex="999999999";overlay.style.color="white";overlay.style.fontFamily="sans-serif";
    overlay.innerHTML=`<h1 style="margin-bottom:40px;">Tahoe OS</h1><div id="userList"></div>`;
    document.body.appendChild(overlay);
    const list=document.getElementById("userList");
    OS.users.forEach(user=>{const btn=document.createElement("div");btn.style.margin="15px";btn.style.padding="20px 40px";btn.style.background="rgba(255,255,255,0.2)";btn.style.borderRadius="20px";btn.style.cursor="pointer";btn.innerText=user.name;btn.onclick=()=>{
        if(user.password){const p=prompt("Enter password:");if(p!==user.password) return alert("Wrong password");}
        overlay.remove();OS.notify("Login Successful","Welcome "+user.name);};list.appendChild(btn);});
};
window.addEventListener("load",()=>{OS.boot();setTimeout(OS.showLogin,500);});
</script>

</body>
</html>
